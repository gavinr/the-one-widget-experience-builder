define(["jimu-core","jimu-ui","jimu-arcgis"],(function(e,t,i){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=282)}({129:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.id="id",this.title="title",this.className="esri-icon",this.group=0,this.widget=null,this.isValid=function(e){return!1},this.execute=function(e){}}return e.prototype.hasActionWithMessage=function(e){return!1},e.prototype.useMapWidget=function(){return this.widget.props.config.useMapWidget},e}();t.default=n},282:function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o,s=i(3),a=i(5),c=i(4),u=i(283),l=i(284),p=i(285),d=i(286),f=i(287),y=i(288);!function(e){e.Pending="Pending",e.Fulfilled="Fulfilled",e.Rejected="Rejected"}(o=t.LoadStatus||(t.LoadStatus={}));var h=function(e){function t(t){var i=e.call(this,t)||this;return i.defineLayerListActions=function(e){var t=e.item,n={};t.actionsSections=[],i.layerListActions.forEach((function(e){if(e.isValid(t)){var i=n[e.group];i||(i=[],n[e.group]=i),i.push({id:e.id,title:e.title,className:e.className})}})),Object.entries(n).sort((function(e,t){return Number(e[0])-Number(t[0])})).forEach((function(e){e[0];var i=e[1];t.actionsSections.push(i)}))},i.onLayerListActionsTriggered=function(e){var t=e.action,n=e.item;i.layerListActions.find((function(e){return e.id===t.id})).execute(n)},i.onActiveViewChange=function(e){var t=i.props.useMapWidgetIds&&i.props.useMapWidgetIds[0];e&&e.view||!t?(i.viewFromMapWidget=e&&e.view,i.setState({mapViewWidgetId:t,viewFromMapWidgetId:e.id})):i.destoryLayerList()},i.onDataSourceCreated=function(e){i.dataSource=e,i.setState({mapDataSourceId:e.id})},i.onCreateDataSourceFailed=function(e){},i.state={mapViewWidgetId:null,mapDataSourceId:null,viewFromMapWidgetId:null,loadStatus:o.Pending},i.renderPromise=Promise.resolve(),i.registerLayerListActions(),i}return r(t,e),t.prototype.componentDidMount=function(){},t.prototype.componentDidUpdate=function(){this.props.config.useMapWidget?this.state.mapViewWidgetId===this.currentUseMapWidgetId&&this.syncRenderer(this.renderPromise):this.state.mapDataSourceId===this.currentUseDataSourceId&&this.syncRenderer(this.renderPromise)},t.prototype.createView=function(){return this.props.config.useMapWidget?Promise.resolve(this.viewFromMapWidget):this.createViewByDatatSource()},t.prototype.createViewByDatatSource=function(){var e=this;return this.loadViewModules(this.dataSource).then((function(){return e.dataSource.type===a.DataSourceTypes.WebMap?new Promise((function(t,i){return e.createWebMapView(e.MapView,t,i)})):e.dataSource.type===a.DataSourceTypes.WebScene?new Promise((function(t,i){return e.createSceneView(e.SceneView,t,i)})):Promise.reject()}))},t.prototype.createWebMapView=function(e,t,i){var n=this;this.destoryView();var r={map:this.dataSource.map,container:this.refs.mapContainer};this.mapView=new e(r),this.mapView.when((function(){t(n.mapView)}),(function(e){return i(e)}))},t.prototype.createSceneView=function(e,t,i){var n=this;this.destoryView();var r={map:this.dataSource.map,container:this.refs.mapContainer};this.sceneView=new this.SceneView(r),this.sceneView.when((function(){t(n.sceneView)}),(function(e){return i(e)}))},t.prototype.destoryView=function(){this.mapView&&!this.mapView.destroyed&&this.mapView.destroy(),this.sceneView&&!this.sceneView.destroyed&&this.sceneView.destroy()},t.prototype.loadViewModules=function(e){var t=this;return e.type===a.DataSourceTypes.WebMap?this.MapView?Promise.resolve(this.MapView):a.loadArcGISJSAPIModules(["esri/views/MapView"]).then((function(e){return t.MapView=e[0],t.MapView})):e.type===a.DataSourceTypes.WebScene?this.SceneView?Promise.resolve(this.SceneView):a.loadArcGISJSAPIModules(["esri/views/SceneView"]).then((function(e){return t.SceneView=e[0],t.SceneView})):Promise.reject()},t.prototype.destoryLayerList=function(){this.layerList&&!this.layerList.destroyed&&this.layerList.destroy()},t.prototype.createLayerList=function(e){var t=this;return(this.LayerList?Promise.resolve():a.loadArcGISJSAPIModules(["esri/widgets/LayerList"]).then((function(e){t.LayerList=e[0]}))).then((function(){var i=document&&document.createElement("div");i.className="jimu-widget",t.refs.layerListContainer.appendChild(i),t.destoryLayerList(),t.layerList=new t.LayerList({view:e,listItemCreatedFunction:t.defineLayerListActions,container:i}),t.configLayerList(),t.layerList.on("trigger-action",(function(e){t.onLayerListActionsTriggered(e)}))}))},t.prototype.registerLayerListActions=function(){this.layerListActions=[new l.default(this,this.props.intl.formatMessage({id:"goto",defaultMessage:f.default.goto})),new p.default(this,this.props.intl.formatMessage({id:"increaseOpacity",defaultMessage:f.default.increaseOpacity}),!0),new p.default(this,this.props.intl.formatMessage({id:"decreaseOpacity",defaultMessage:f.default.decreaseOpacity}),!1),new d.default(this,this.props.intl.formatMessage({id:"information",defaultMessage:f.default.information}))]},t.prototype.configLayerList=function(){this.props.config.setVisibility&&this.props.config.useMapWidget||(this.layerList._toggleVisibility=function(){})},t.prototype.renderLayerList=function(){var e=this;return this.createView().then((function(t){return e.createLayerList(t)})).then((function(){e.setState({loadStatus:o.Fulfilled})})).catch((function(e){return console.error(e)}))},t.prototype.syncRenderer=function(e){var t=this;this.renderPromise=new Promise((function(i,n){e.then((function(){t.renderLayerList().then((function(){i()})).catch((function(){return n()}))}))}))},t.prototype.render=function(){var e=this.props.useMapWidgetIds&&this.props.useMapWidgetIds[0],t=this.props.useDataSources&&this.props.useDataSources[0];this.currentUseMapWidgetId=e,this.currentUseDataSourceId=t&&t.dataSourceId;var i=null;this.props.config.useMapWidget?i=s.jsx(a.JimuMapViewComponent,{useMapWidgetIds:this.props.useMapWidgetIds,onActiveViewChange:this.onActiveViewChange}):t&&(i=s.jsx(s.DataSourceComponent,{useDataSource:t,onDataSourceCreated:this.onDataSourceCreated,onCreateDataSourceFailed:this.onCreateDataSourceFailed}));var n=null;if(this.props.config.useMapWidget?e:t){var r=null;this.state.loadStatus===o.Pending&&(r=s.jsx("div",{style:{position:"absolute",left:"50%",top:"50%"},className:"jimu-secondary-loading"})),n=s.jsx("div",{className:"widget-layerlist"},r,s.jsx("div",{ref:"layerListContainer"}),s.jsx("div",{style:{position:"absolute",opacity:0},ref:"mapContainer"},"mapContainer"),s.jsx("div",{style:{position:"absolute",display:"none"}},i))}else this.destoryLayerList(),n=s.jsx("div",{className:"widget-layerlist"},s.jsx(c.WidgetPlaceholder,{icon:y,message:this.props.intl.formatMessage({id:"_widgetLabel",defaultMessage:f.default._widgetLabel}),widgetId:this.props.id}));return s.jsx("div",{css:u.getStyle(this.props.theme,this.props.config),className:"jimu-widget"},n)},t}(s.BaseWidget);t.default=h},283:function(e,t,i){"use strict";var n=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var r,o=i(3);t.getStyle=function(e,t){var i,s;return t.setVisibility&&t.useMapWidget?(i="block",s=""):(i="none",s="unset"),o.css(r||(r=n(["\n    overflow: auto;\n    .widget-layerlist {\n      width: 100%;\n      height: 100%;\n\n      .esri-layer-list {\n        background-color: ",";\n        color: ","\n      }\n\n      .esri-layer-list__item {\n        background-color: ",";\n      }\n      .esri-layer-list__item-label:focus {\n        outline: ",";\n      }\n\n      .esri-layer-list__item--invisible-at-scale .esri-layer-list__item-title {\n        color: ","\n      }\n\n      .esri-layer-list__child-toggle{\n        color: ","\n      }\n\n      .esri-layer-list__item-toggle-icon {\n        display: ",";\n      }\n\n      .esri-layer-list__item-actions-menu-item:hover {\n        background-color: ",";\n      }\n\n      .esri-layer-list__item-actions-menu-item--active, .esri-layer-list__item-actions-menu-item--active:hover {\n        background-color: ",";\n      }\n\n      .esri-layer-list__item-actions {\n        background-color: ",";\n        color: ","\n      }\n      \n      .esri-layer-list__item-action:hover {\n        background-color: ",";\n      }\n\n      .esri-layer-list__item-actions-list {\n        border-color: ",";\n      }\n    }\n  "],["\n    overflow: auto;\n    .widget-layerlist {\n      width: 100%;\n      height: 100%;\n\n      .esri-layer-list {\n        background-color: ",";\n        color: ","\n      }\n\n      .esri-layer-list__item {\n        background-color: ",";\n      }\n      .esri-layer-list__item-label:focus {\n        outline: ",";\n      }\n\n      .esri-layer-list__item--invisible-at-scale .esri-layer-list__item-title {\n        color: ","\n      }\n\n      .esri-layer-list__child-toggle{\n        color: ","\n      }\n\n      .esri-layer-list__item-toggle-icon {\n        display: ",";\n      }\n\n      .esri-layer-list__item-actions-menu-item:hover {\n        background-color: ",";\n      }\n\n      .esri-layer-list__item-actions-menu-item--active, .esri-layer-list__item-actions-menu-item--active:hover {\n        background-color: ",";\n      }\n\n      .esri-layer-list__item-actions {\n        background-color: ",";\n        color: ","\n      }\n      \n      .esri-layer-list__item-action:hover {\n        background-color: ",";\n      }\n\n      .esri-layer-list__item-actions-list {\n        border-color: ",";\n      }\n    }\n  "])),e.colors.palette.light[100],e.colors.black,e.colors.palette.light[100],s,e.colors.palette.light[800],e.colors.black,i,e.colors.palette.light[300],e.colors.palette.light[300],e.colors.palette.light[200],e.colors.black,e.colors.palette.light[300],e.colors.palette.light[500])}},284:function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=i(129),s=i(5),a=function(e){function t(t,i){var n=e.call(this)||this;return n.isValid=function(e){return!e.parent&&!(!n.useMapWidget()||!n.widget.props.config.goto)},n.execute=function(e){n.widget.viewFromMapWidget&&s.zoomToUtils.zoomTo(n.widget.viewFromMapWidget,e.layer,{})},n.id="goto",n.title=i,n.className="esri-icon-zoom-out-fixed",n.group=0,n.widget=t,n}return r(t,e),t}(o.default);t.default=a},285:function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,i,n){var r=e.call(this)||this;return r.isValid=function(e){return!e.parent&&!(!r.useMapWidget()||!r.widget.props.config.opacity)},r.execute=function(e){r.isIncreaseOpacity?e.layer.opacity<1&&(e.layer.opacity+=.25):e.layer.opacity>0&&(e.layer.opacity-=.25)},r.id=n?"increaseOpacity":"decreaseOpacity",r.title=i,r.className=n?"esri-icon-up":"esri-icon-down",r.group=1,r.widget=t,r.isIncreaseOpacity=n,r}return r(t,e),t}(i(129).default);t.default=o},286:function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,i){var n=e.call(this)||this;return n.isValid=function(e){return!(!e.layer.url||!n.widget.props.config.information)},n.execute=function(e){window.open(e.layer.url)},n.id="information",n.title=i,n.className="esri-icon-description",n.group=3,n.widget=t,n}return r(t,e),t}(i(129).default);t.default=o},287:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={_widgetLabel:"Map Layers",goto:"Zoom to",information:"Details",increaseOpacity:"Increase opacity",decreaseOpacity:"Decrease opacity"}},288:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M16 10.05v1.104L8 15l-8-3.846V10.05l8 3.833 8-3.833zm0-3.017v1.105l-8 3.846-8-3.846V7.033l8 3.833 8-3.833zM8 1l8 3.799-8 3.799-8-3.8L8 1zm0 1.118l-5.646 2.68L8 7.48l5.646-2.681L8 2.118z" fill="#000" fill-rule="nonzero"></path></svg>'},3:function(t,i){t.exports=e},4:function(e,i){e.exports=t},5:function(e,t){e.exports=i}})}));