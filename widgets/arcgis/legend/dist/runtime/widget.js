define(["jimu-core","jimu-ui","jimu-arcgis"],(function(e,n,t){return function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=275)}({275:function(e,n,t){"use strict";var o,r=this&&this.__extends||(o=function(e,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(e,n)},function(e,n){function t(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0});var i,a=t(3),c=t(5),s=t(4),d=t(276),l=t(277),u=t(278);!function(e){e.Pending="Pending",e.Fulfilled="Fulfilled",e.Rejected="Rejected"}(i=n.LoadStatus||(n.LoadStatus={}));var p=function(e){function n(n){var t=e.call(this,n)||this;return t.componentDidMount=function(){},t.createWebMapView=function(e,n,o){t.destoryView();var r={map:t.dataSource.map,container:t.refs.mapContainer};t.mapView=new e(r),t.mapView.when((function(){n(t.mapView)}),(function(e){return o(e)}))},t.createSceneView=function(e,n,o){t.destoryView();var r={map:t.dataSource.map,container:t.refs.mapContainer};t.sceneView=new t.SceneView(r),t.sceneView.when((function(){n(t.sceneView)}),(function(e){return o(e)}))},t.loadViewModules=function(e){return e.type===c.DataSourceTypes.WebMap?t.MapView?Promise.resolve(t.MapView):c.loadArcGISJSAPIModules(["esri/views/MapView"]).then((function(e){return t.MapView=e[0],t.MapView})):e.type===c.DataSourceTypes.WebScene?t.SceneView?Promise.resolve(t.SceneView):c.loadArcGISJSAPIModules(["esri/views/SceneView"]).then((function(e){return t.SceneView=e[0],t.SceneView})):Promise.reject()},t.destoryLegend=function(){t.legend&&!t.legend.destroyed&&t.legend.destroy()},t.createLegend=function(e){return(t.Legend?Promise.resolve():c.loadArcGISJSAPIModules(["esri/widgets/Legend"]).then((function(e){t.Legend=e[0]}))).then((function(){var n=document&&document.createElement("div");n.className="jimu-widget",t.refs.legendContainer.appendChild(n),t.destoryLegend(),t.legend=new t.Legend({view:e,container:n}),t.configLegend()}))},t.configLegend=function(){if(t.legend){var e=t.props.config.cardStyle?{type:"card",layout:t.props.config.cardLayout||"auto"}:"classic",n=t.props.config.showBaseMap;t.legend.style=e,t.legend.basemapLegendVisible=n}},t.onActiveViewChange=function(e){e&&e.view?t.createLegend(e.view).then((function(){t.setState({loadStatus:i.Fulfilled})})).catch((function(e){return console.error(e)})):t.destoryLegend()},t.onDataSourceCreated=function(e){t.dataSource=e,t.createViewByDataSource(e).then((function(e){return t.createLegend(e)})).then((function(){t.setState({loadStatus:i.Fulfilled})})).catch((function(e){return console.error(e)}))},t.onCreateDataSourceFailed=function(e){},t.state={loadStatus:i.Pending},t}return r(n,e),n.prototype.createViewByDataSource=function(e){var n=this;return this.loadViewModules(e).then((function(){return e.type===c.DataSourceTypes.WebMap?new Promise((function(e,t){return n.createWebMapView(n.MapView,e,t)})):e.type===c.DataSourceTypes.WebScene?new Promise((function(e,t){return n.createSceneView(n.SceneView,e,t)})):Promise.reject()}))},n.prototype.destoryView=function(){this.mapView&&!this.mapView.destroyed&&this.mapView.destroy(),this.sceneView&&!this.sceneView.destroyed&&this.sceneView.destroy()},n.prototype.render=function(){var e=this.props.useMapWidgetIds&&this.props.useMapWidgetIds[0],n=this.props.useDataSources&&this.props.useDataSources[0],t=null,o=null;if(e?o=a.jsx(c.JimuMapViewComponent,{useMapWidgetIds:this.props.useMapWidgetIds,onActiveViewChange:this.onActiveViewChange}):n&&(o=a.jsx(a.DataSourceComponent,{useDataSource:n,onDataSourceCreated:this.onDataSourceCreated,onCreateDataSourceFailed:this.onCreateDataSourceFailed})),e||n){var r=null;this.state.loadStatus===i.Pending&&(r=a.jsx("div",{style:{position:"absolute",left:"50%",top:"50%"},className:"jimu-secondary-loading"})),window.jimuConfig.isInBuilder&&this.configLegend(),t=a.jsx("div",{className:"widget-legend"},r,a.jsx("div",{ref:"legendContainer"}),a.jsx("div",{style:{position:"absolute",opacity:0},ref:"mapContainer"},"mapContainer"),a.jsx("div",{style:{position:"absolute",display:"none"}},o))}else this.destoryLegend(),t=a.jsx("div",{className:"widget-legend"},a.jsx(s.WidgetPlaceholder,{icon:u,autoFlip:!0,message:this.props.intl.formatMessage({id:"_widgetLabel",defaultMessage:l.default._widgetLabel}),widgetId:this.props.id}));return a.jsx("div",{css:d.getStyle(this.props.theme),className:"jimu-widget"},t)},n}(a.BaseWidget);n.default=p},276:function(e,n,t){"use strict";var o=this&&this.__makeTemplateObject||function(e,n){return Object.defineProperty?Object.defineProperty(e,"raw",{value:n}):e.raw=n,e};Object.defineProperty(n,"__esModule",{value:!0});var r,i=t(3);n.getStyle=function(e){return i.css(r||(r=o(["\n    overflow: auto;\n    .widget-legend {\n      width: 100%;\n      height: 100%;\n\n      .esri-legend {\n        background-color: ",";\n        color: ","\n      }\n\n      .esri-widget__heading {\n        color: ",";\n      }\n\n      .esri-legend--card.esri-widget{\n        background-color: ",";\n        color: ","\n      }\n\n      .esri-legend--card__section {\n        width: 100%;\n        background-color: ",";\n        color: ","\n      }\n\n      .esri-legend--card__carousel-indicator-container {\n        background-color: ",";\n      }\n\n      .esri-legend--card__service {\n        width: 100%;\n      }\n\n      .esri-legend--card__service-caption-container {\n        background-color: ",";\n        color: ",";\n      }\n\n      /*\n      .esri-legend--card__carousel-indicator {\n        background-color: ",";\n      }\n      */\n    }\n  "],["\n    overflow: auto;\n    .widget-legend {\n      width: 100%;\n      height: 100%;\n\n      .esri-legend {\n        background-color: ",";\n        color: ","\n      }\n\n      .esri-widget__heading {\n        color: ",";\n      }\n\n      .esri-legend--card.esri-widget{\n        background-color: ",";\n        color: ","\n      }\n\n      .esri-legend--card__section {\n        width: 100%;\n        background-color: ",";\n        color: ","\n      }\n\n      .esri-legend--card__carousel-indicator-container {\n        background-color: ",";\n      }\n\n      .esri-legend--card__service {\n        width: 100%;\n      }\n\n      .esri-legend--card__service-caption-container {\n        background-color: ",";\n        color: ",";\n      }\n\n      /*\n      .esri-legend--card__carousel-indicator {\n        background-color: ",";\n      }\n      */\n    }\n  "])),e.colors.palette.light[100],e.colors.black,e.colors.black,e.colors.palette.light[300],e.colors.black,e.colors.palette.light[100],e.colors.black,e.colors.palette.light[300],e.colors.palette.light[300],e.colors.black,e.colors.palette.dark[900])}},277:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={_widgetLabel:"Legend"}},278:function(e,n){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M1.5 11a1.5 1.5 0 110 3 1.5 1.5 0 010-3zm14 1a.5.5 0 110 1h-10a.5.5 0 110-1h10zM3 6v3H0V6h3zm12.5 1a.5.5 0 110 1h-10a.5.5 0 010-1h10zm-14-6L3 4H0l1.5-3zm14 1a.5.5 0 110 1h-10a.5.5 0 010-1h10z" fill="#000" fill-rule="evenodd"></path></svg>'},3:function(n,t){n.exports=e},4:function(e,t){e.exports=n},5:function(e,n){e.exports=t}})}));